version: 2.1 # Use version 2.1 to enable Orb usage.

parameters:
  skipUnitTests:
    description: if set to true will not build the c++ unit tests
    type: boolean
    default: true
  skipSystemTests:
    description: if set to true will not build the c++ system tests
    type: boolean
    default: true
  updateTranslation:
    description: if set to true will update the translation files
    type: boolean
    default: true


jobs:
  build_cpp_unit_tests:
    docker:
      - image: cimg/base:edge
    steps:
      - checkout
      - run: echo "This was triggered by << pipeline.trigger_source >>"
  artefacts_build_only_job:
    docker:
      - image: cimg/base:edge
    steps:
      - checkout
      - run: echo "This was triggered by << pipeline.trigger_source >>"
  system_tests_job:
    docker:
      - image: cimg/base:edge
    steps:
      - checkout
      - run: echo "This was triggered by << pipeline.trigger_source >>"


workflows:
  unit_tests_workflow: 
    when:
      and:
        - not: <<pipeline.parameters.skipUnitTests>>
    jobs:
    - build_cpp_unit_tests
  artefacts_build_only_workflow: 
    when:
      and:
        - not: <<pipeline.parameters.skipUnitTests>>
    jobs:
    - artefacts_build_only_job
  artefacts_build_and_unittest:
    when:
      and:
        - not: <<pipeline.parameters.skipUnitTests>>
    jobs:
    - build_cpp_unit_tests
    - artefacts_build_only_job
  artefacts_build_and_systemtest:
    when:
      and:
        - not: <<pipeline.parameters.skipSystemTests>>
    jobs:
    - artefacts_build_only_job
    - system_tests_job